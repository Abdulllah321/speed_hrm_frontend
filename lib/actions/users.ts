"use server";
import { authFetch } from "@/lib/auth";import { revalidatePath } from "next/cache";export interface User {  id: string;  email: string;  firstName: string;  lastName: string;  status: string;  isDashboardEnabled?: boolean;  roleId?: string;  role?: {    id: string;    name: string;  };  employeeId?: string;  employee?: {    id: string;    employeeName: string;    designation?: { name: string };    department?: { name: string };  };}export async function getUsers(): Promise<{ status: boolean; data: User[]; message?: string }> {  try {    const res = await authFetch(`/auth/users`, {    });    const payload = await res.json();    const users = Array.isArray(payload?.data) ? payload.data : (Array.isArray(payload) ? payload : []);    return { status: true, data: users };  } catch (error) {    console.error("Failed to fetch users:", error);    return { status: false, data: [], message: "Failed to fetch users" };  }}export async function createUser(data: {  email: string;  firstName: string;  lastName: string;  password?: string;  employeeId?: string;  roleId?: string}) {  try {    // Default password if not provided    const payload = {      ...data,      password: data.password || "Password@123", // Default password      isDashboardEnabled: false // Explicitly disable dashboard access by default    };    const res = await authFetch(`/auth/users`, {      method: "POST",      body: JSON.stringify(payload),    });    if (!res.ok) {      let message = "Failed to create user";      try {        const error = await res.json();        message = error.message || message;      } catch {        try {          const text = await res.text();          // Common server message when route not found          message = text || message;        } catch { }      }      return { status: false, message };    }    revalidatePath("/hr/employee/user-account");    return { status: true, message: "User account created successfully" };  } catch (error) {    return { status: false, message: "Failed to create user account" };  }}export async function updateUserRole(userId: string, roleId: string | null) {  try {    const res = await authFetch(`/auth/users/update`, {      method: "POST",      body: JSON.stringify({        id: userId,        data: { roleId }      }),    });    if (!res.ok) {      const error = await res.json();      return { status: false, message: error.message || "Failed to update user role" };    }    revalidatePath("/hr/employee/user-account");    return { status: true, message: "User role updated successfully" };  } catch (error) {    return { status: false, message: "Failed to update user role" };  }}export async function updateUserDashboardAccess(userId: string, hasAccess: boolean) {  try {    const res = await authFetch(`/auth/users/update`, {      method: "POST",      body: JSON.stringify({        id: userId,        data: { isDashboardEnabled: hasAccess }      }),    });    if (!res.ok) {      const error = await res.json();      return { status: false, message: error.message || "Failed to update dashboard access" };    }    revalidatePath("/hr/employee/user-account");    return { status: true, message: "Dashboard access updated successfully" };  } catch (error) {    return { status: false, message: "Failed to update dashboard access" };  }}